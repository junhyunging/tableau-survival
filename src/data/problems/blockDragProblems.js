const SAMPLE_DATA = [
  { category: '가구', region: '서울', segment: '소비자', month: '1월', sales: 450000, quantity: 12, discount: 0.1, profit: 85000 },
  { category: '가구', region: '부산', segment: '기업', month: '2월', sales: 320000, quantity: 8, discount: 0.05, profit: 64000 },
  { category: '가구', region: '대구', segment: '소비자', month: '3월', sales: 280000, quantity: 6, discount: 0.15, profit: 42000 },
  { category: '기술', region: '서울', segment: '소비자', month: '1월', sales: 780000, quantity: 25, discount: 0.15, profit: 156000 },
  { category: '기술', region: '부산', segment: '홈오피스', month: '2월', sales: 560000, quantity: 18, discount: 0.1, profit: 112000 },
  { category: '기술', region: '대구', segment: '기업', month: '3월', sales: 420000, quantity: 14, discount: 0.05, profit: 84000 },
  { category: '사무용품', region: '서울', segment: '기업', month: '1월', sales: 230000, quantity: 45, discount: 0.2, profit: 34500 },
  { category: '사무용품', region: '부산', segment: '소비자', month: '2월', sales: 180000, quantity: 32, discount: 0.15, profit: 27000 },
  { category: '사무용품', region: '대구', segment: '홈오피스', month: '3월', sales: 150000, quantity: 28, discount: 0.1, profit: 22500 },
]

const STANDARD_BLOCKS = {
  chartTypes: [
    { id: 'bar', name: '막대차트', type: 'chartType' },
    { id: 'line', name: '라인차트', type: 'chartType' },
    { id: 'pie', name: '파이차트', type: 'chartType' },
  ],
  dimensions: [
    { id: 'category', name: '카테고리', type: 'dimension', color: '#4B89DC' },
    { id: 'region', name: '지역', type: 'dimension', color: '#4B89DC' },
    { id: 'segment', name: '세그먼트', type: 'dimension', color: '#4B89DC' },
    { id: 'month', name: '월', type: 'dimension', color: '#4B89DC' },
  ],
  measures: [
    { id: 'sales', name: '매출액', type: 'measure', color: '#48A868' },
    { id: 'quantity', name: '수량', type: 'measure', color: '#48A868' },
    { id: 'discount', name: '할인율', type: 'measure', color: '#48A868' },
    { id: 'profit', name: '이익', type: 'measure', color: '#48A868' },
  ],
}

const STANDARD_SLOTS = [
  { id: 'chartType', label: '차트 종류', accepts: ['chartType'], required: true },
  { id: 'xAxis', label: '가로축 (열)', accepts: ['dimension', 'measure'], required: true },
  { id: 'yAxis', label: '세로축 (행)', accepts: ['dimension', 'measure'], required: true },
  { id: 'colorBy', label: '색상', accepts: ['dimension', 'measure'], required: false },
  { id: 'sizeBy', label: '크기', accepts: ['dimension', 'measure'], required: false },
  { id: 'labelBy', label: '레이블', accepts: ['dimension', 'measure'], required: false },
  { id: 'detailBy', label: '세부 정보', accepts: ['dimension'], required: false },
  { id: 'tooltipBy', label: '도구 설명', accepts: ['dimension', 'measure'], required: false },
  { id: 'filter', label: '필터', accepts: ['dimension'], required: false },
]

const COHORT_SAMPLE_DATA = [
  { cohortMonth: '1월 코호트', cohortWeek: '0주', retentionRate: 100, customerCount: 120 },
  { cohortMonth: '1월 코호트', cohortWeek: '1주', retentionRate: 62, customerCount: 74 },
  { cohortMonth: '1월 코호트', cohortWeek: '2주', retentionRate: 48, customerCount: 58 },
  { cohortMonth: '2월 코호트', cohortWeek: '0주', retentionRate: 100, customerCount: 135 },
  { cohortMonth: '2월 코호트', cohortWeek: '1주', retentionRate: 58, customerCount: 78 },
  { cohortMonth: '2월 코호트', cohortWeek: '2주', retentionRate: 44, customerCount: 59 },
  { cohortMonth: '3월 코호트', cohortWeek: '0주', retentionRate: 100, customerCount: 142 },
  { cohortMonth: '3월 코호트', cohortWeek: '1주', retentionRate: 55, customerCount: 78 },
  { cohortMonth: '3월 코호트', cohortWeek: '2주', retentionRate: 39, customerCount: 55 },
]

const COHORT_BLOCKS = {
  chartTypes: STANDARD_BLOCKS.chartTypes,
  dimensions: [
    { id: 'cohortWeek', name: '경과주차', type: 'dimension', color: '#4B89DC' },
    { id: 'cohortMonth', name: '코호트월', type: 'dimension', color: '#4B89DC' },
  ],
  measures: [
    { id: 'retentionRate', name: '리텐션율', type: 'measure', color: '#48A868' },
    { id: 'customerCount', name: '고객수', type: 'measure', color: '#48A868' },
  ],
}

export const blockDragProblems = [
  {
    id: 'block_01',
    type: 'block_drag',
    category: 'dimension_measure',
    difficulty: 'beginner',
    day: 1,
    period: 'afternoon',
    instruction: '카테고리별 매출 합계를 막대차트로 만드세요.',
    availableBlocks: STANDARD_BLOCKS,
    slots: STANDARD_SLOTS,
    correctAnswer: {
      chartType: 'bar',
      xAxis: 'category',
      yAxis: 'sales',
    },
    alternativeAnswers: [
      { chartType: 'bar', xAxis: 'sales', yAxis: 'category' },
    ],
    sampleData: SAMPLE_DATA,
    explanation: '차원(카테고리)을 가로축에, 측정값(매출액)을 세로축에 놓으면 카테고리별 매출 막대차트가 됩니다.',
    hint: '막대차트의 가로축엔 분류 기준(차원), 세로축엔 수치(측정값)를 놓아보세요.',
    gaugeChange: { correct: 5, incorrect: -10 },
  },
  {
    id: 'block_02',
    type: 'block_drag',
    category: 'continuous_discrete',
    difficulty: 'beginner',
    day: 2,
    period: 'afternoon',
    instruction: '월별 매출 추이를 라인차트로 만드세요.',
    availableBlocks: STANDARD_BLOCKS,
    slots: STANDARD_SLOTS,
    correctAnswer: {
      chartType: 'line',
      xAxis: 'month',
      yAxis: 'sales',
    },
    alternativeAnswers: [],
    sampleData: SAMPLE_DATA,
    explanation: '라인차트는 시간의 흐름에 따른 추이를 보여주기에 적합합니다. 가로축에 월, 세로축에 매출을 놓으세요.',
    hint: '시간 순서를 보여주는 차트에는 라인차트가 적합해요.',
    gaugeChange: { correct: 5, incorrect: -10 },
  },
  {
    id: 'block_03',
    type: 'block_drag',
    category: 'continuous_discrete',
    difficulty: 'intermediate',
    day: 2,
    period: 'afternoon',
    instruction: '지역별 매출을 막대차트로 만들되, 카테고리별로 색상을 구분하세요.',
    availableBlocks: STANDARD_BLOCKS,
    slots: STANDARD_SLOTS,
    correctAnswer: {
      chartType: 'bar',
      xAxis: 'region',
      yAxis: 'sales',
      colorBy: 'category',
    },
    alternativeAnswers: [
      { chartType: 'bar', xAxis: 'sales', yAxis: 'region', colorBy: 'category' },
    ],
    sampleData: SAMPLE_DATA,
    explanation: '색상 구분에 차원을 넣으면 하나의 막대가 여러 색으로 나뉘어 비교할 수 있습니다.',
    hint: '색상 구분 슬롯에 차원을 넣어보세요!',
    gaugeChange: { correct: 5, incorrect: -10 },
  },
  {
    id: 'block_04',
    type: 'block_drag',
    category: 'comprehensive',
    difficulty: 'intermediate',
    day: 5,
    period: 'morning',
    instruction: '세그먼트별 이익 합계를 파이차트로 만드세요.',
    availableBlocks: STANDARD_BLOCKS,
    slots: STANDARD_SLOTS,
    correctAnswer: {
      chartType: 'pie',
      xAxis: 'segment',
      yAxis: 'profit',
      colorBy: 'segment',
    },
    alternativeAnswers: [
      { chartType: 'pie', xAxis: 'profit', yAxis: 'segment', colorBy: 'segment' },
    ],
    sampleData: SAMPLE_DATA,
    explanation: '파이차트는 전체 대비 비율을 보여주기에 적합합니다. 실제 태블로에서도 파이차트의 조각별 색상을 구분하려면 색상 마크에 차원을 넣어야 합니다. 세그먼트를 색상 구분에 넣어 각 세그먼트가 다른 색으로 보이게 하세요.',
    hint: '파이차트 조각을 서로 다른 색으로 보려면 색상 구분 슬롯에 차원을 넣어야 해요!',
    gaugeChange: { correct: 5, incorrect: -10 },
  },
  {
    id: 'block_05',
    type: 'block_drag',
    category: 'data_connection',
    difficulty: 'intermediate',
    day: 5,
    period: 'afternoon',
    instruction: '데이터 연결 후 필터 동작을 점검하기 위해 카테고리별 매출 막대차트를 만들고, 필터 선반에 지역을 추가하세요.',
    availableBlocks: STANDARD_BLOCKS,
    slots: STANDARD_SLOTS,
    correctAnswer: {
      chartType: 'bar',
      xAxis: 'category',
      yAxis: 'sales',
      filter: 'region',
    },
    alternativeAnswers: [
      { chartType: 'bar', xAxis: 'sales', yAxis: 'category', filter: 'region' },
    ],
    sampleData: SAMPLE_DATA,
    explanation: '실무에서는 데이터 연결 직후 기본 차트를 만들어 필드 인식과 필터 적용 여부를 함께 점검합니다. 필터 선반에 차원을 올려 필터 박스 구성 준비를 할 수 있습니다.',
    hint: '차트(카테고리-매출)를 먼저 만들고, 필터 슬롯에 차원(지역)을 추가해보세요.',
    gaugeChange: { correct: 5, incorrect: -10 },
  },
  // === Chapter 10: KPI 대시보드 ===
  {
    id: 'block_06',
    type: 'block_drag',
    category: 'kpi',
    difficulty: 'intermediate',
    instruction: '지역별 이익 합계를 막대차트로 만들고, 레이블을 표시하세요.',
    availableBlocks: STANDARD_BLOCKS,
    slots: STANDARD_SLOTS,
    correctAnswer: {
      chartType: 'bar',
      xAxis: 'region',
      yAxis: 'profit',
      labelBy: 'profit',
    },
    alternativeAnswers: [
      { chartType: 'bar', xAxis: 'profit', yAxis: 'region', labelBy: 'profit' },
    ],
    sampleData: SAMPLE_DATA,
    explanation: 'KPI 대시보드에서는 핵심 지표를 명확하게 보여줘야 합니다. 레이블을 추가하면 정확한 수치를 바로 확인할 수 있어요.',
    hint: '지역=가로축, 이익=세로축, 레이블에 이익을 넣어보세요.',
    gaugeChange: { correct: 5, incorrect: -10 },
  },
  // === Chapter 11: 퍼널 분석 ===
  {
    id: 'block_07',
    type: 'block_drag',
    category: 'funnel',
    difficulty: 'intermediate',
    instruction: '세그먼트별 수량을 가로 막대차트로 만들어 퍼널 형태로 표현하세요.',
    availableBlocks: STANDARD_BLOCKS,
    slots: STANDARD_SLOTS,
    correctAnswer: {
      chartType: 'bar',
      xAxis: 'quantity',
      yAxis: 'segment',
    },
    alternativeAnswers: [],
    sampleData: SAMPLE_DATA,
    explanation: '퍼널 차트는 가로 막대차트의 형태입니다. 세그먼트를 세로축에, 수량을 가로축에 놓으면 각 단계의 크기를 비교할 수 있습니다.',
    hint: '가로 막대차트 = 차원이 세로축, 측정값이 가로축입니다.',
    gaugeChange: { correct: 5, incorrect: -10 },
  },
  // === Chapter 12: 파레토 분석 ===
  {
    id: 'block_08',
    type: 'block_drag',
    category: 'pareto',
    difficulty: 'advanced',
    instruction: '카테고리별 이익 막대차트를 만들고, 색상으로 이익 크기를 그라데이션 표현하세요.',
    availableBlocks: STANDARD_BLOCKS,
    slots: STANDARD_SLOTS,
    correctAnswer: {
      chartType: 'bar',
      xAxis: 'category',
      yAxis: 'profit',
      colorBy: 'profit',
    },
    alternativeAnswers: [
      { chartType: 'bar', xAxis: 'profit', yAxis: 'category', colorBy: 'profit' },
    ],
    sampleData: SAMPLE_DATA,
    explanation: '측정값을 색상에 넣으면 값의 크기에 따라 그라데이션으로 표현됩니다. 파레토 분석에서 상위 항목을 시각적으로 강조하는 기법입니다.',
    hint: '색상 슬롯에 측정값(이익)을 넣으면 그라데이션이 적용됩니다.',
    gaugeChange: { correct: 5, incorrect: -10 },
  },
  // === Chapter 14: 코호트 분석 ===
  {
    id: 'block_09',
    type: 'block_drag',
    category: 'cohort',
    difficulty: 'intermediate',
    instruction: '코호트 리텐션 추이를 확인하기 위해 경과주차별 리텐션율 라인차트를 만들고, 코호트월별로 색상을 구분하세요.',
    availableBlocks: COHORT_BLOCKS,
    slots: STANDARD_SLOTS,
    correctAnswer: {
      chartType: 'line',
      xAxis: 'cohortWeek',
      yAxis: 'retentionRate',
      colorBy: 'cohortMonth',
    },
    alternativeAnswers: [],
    sampleData: COHORT_SAMPLE_DATA,
    explanation: '코호트 분석에서는 경과 시점(주차/월차)별 리텐션 변화를 코호트별로 나눠 비교합니다. 코호트월을 색상에 넣으면 코호트별 열화 패턴을 한눈에 비교할 수 있습니다.',
    hint: '가로축=경과주차, 세로축=리텐션율, 색상=코호트월 조합을 맞춰보세요.',
    gaugeChange: { correct: 5, incorrect: -10 },
  },
  // === Chapter 16: 분포와 이상값 ===
  {
    id: 'block_10',
    type: 'block_drag',
    category: 'distribution',
    difficulty: 'intermediate',
    instruction: '지역별 할인율을 막대차트로 만들고, 카테고리별로 색상을 구분하세요.',
    availableBlocks: STANDARD_BLOCKS,
    slots: STANDARD_SLOTS,
    correctAnswer: {
      chartType: 'bar',
      xAxis: 'region',
      yAxis: 'discount',
      colorBy: 'category',
    },
    alternativeAnswers: [
      { chartType: 'bar', xAxis: 'discount', yAxis: 'region', colorBy: 'category' },
    ],
    sampleData: SAMPLE_DATA,
    explanation: '할인율의 분포를 지역과 카테고리별로 비교하면 이상적으로 높은 할인이 어디서 발생하는지 파악할 수 있습니다.',
    hint: '지역=가로축, 할인율=세로축, 카테고리=색상입니다.',
    gaugeChange: { correct: 5, incorrect: -10 },
  },
  // === Chapter 17: 설계 원칙 ===
  {
    id: 'block_11',
    type: 'block_drag',
    category: 'design',
    difficulty: 'intermediate',
    instruction: '와이어프레임의 트렌드 영역을 구성하세요: 월별 매출 라인차트에 레이블을 추가하고 필터 선반에 지역을 넣으세요.',
    availableBlocks: STANDARD_BLOCKS,
    slots: STANDARD_SLOTS,
    correctAnswer: {
      chartType: 'line',
      xAxis: 'month',
      yAxis: 'sales',
      labelBy: 'sales',
      filter: 'region',
    },
    alternativeAnswers: [],
    sampleData: SAMPLE_DATA,
    explanation: '설계 원칙에서는 "어디에 어떤 정보를 둘지"가 핵심입니다. 트렌드 영역엔 시간축 라인차트, 그리고 지역 필터를 함께 배치해 사용자 탐색 동선을 설계합니다.',
    hint: '트렌드 차트(월-매출) + 레이블 + 지역 필터를 함께 배치해보세요.',
    gaugeChange: { correct: 5, incorrect: -10 },
  },
  // === Chapter 18: 액션과 인터랙션 ===
  {
    id: 'block_12',
    type: 'block_drag',
    category: 'action',
    difficulty: 'intermediate',
    instruction: '필터 액션 소스 시트를 구성하세요: 지역별 매출 막대차트를 만들고 세그먼트를 색상과 세부 정보에 넣으세요.',
    availableBlocks: STANDARD_BLOCKS,
    slots: STANDARD_SLOTS,
    correctAnswer: {
      chartType: 'bar',
      xAxis: 'region',
      yAxis: 'sales',
      colorBy: 'segment',
      detailBy: 'segment',
    },
    alternativeAnswers: [
      { chartType: 'bar', xAxis: 'sales', yAxis: 'region', colorBy: 'segment', detailBy: 'segment' },
    ],
    sampleData: SAMPLE_DATA,
    explanation: '필터 액션 소스 시트는 "무엇을 클릭했는지"를 명확히 전달해야 합니다. 색상과 세부 정보에 세그먼트를 넣으면 액션 대상 시트에서 선택 맥락을 정확히 사용할 수 있습니다.',
    hint: '지역-매출 막대차트를 만든 뒤 세그먼트를 색상과 세부 정보에 함께 넣어보세요.',
    gaugeChange: { correct: 5, incorrect: -10 },
  },
  // === Chapter 20: 종합 ===
  {
    id: 'block_13',
    type: 'block_drag',
    category: 'comprehensive',
    difficulty: 'advanced',
    instruction: '지역별 이익 막대차트를 만들고, 세그먼트별 색상 구분과 레이블을 모두 표시하세요.',
    availableBlocks: STANDARD_BLOCKS,
    slots: STANDARD_SLOTS,
    correctAnswer: {
      chartType: 'bar',
      xAxis: 'region',
      yAxis: 'profit',
      colorBy: 'segment',
      labelBy: 'profit',
    },
    alternativeAnswers: [
      { chartType: 'bar', xAxis: 'profit', yAxis: 'region', colorBy: 'segment', labelBy: 'profit' },
    ],
    sampleData: SAMPLE_DATA,
    explanation: '종합 대시보드에서는 여러 마크 속성을 함께 활용합니다. 축으로 구조를 잡고, 색상으로 분류하고, 레이블로 정확한 값을 보여주는 것이 완성도 높은 시각화입니다.',
    hint: '지역=가로축, 이익=세로축, 세그먼트=색상, 이익=레이블을 모두 넣어보세요.',
    gaugeChange: { correct: 5, incorrect: -10 },
  },
]
