export const calcFieldProblems = [
  {
    id: 'calc_01',
    type: 'calc_field',
    subcategory: 'logic',
    difficulty: 'intermediate',
    day: 3,
    period: 'morning',
    instruction: '매출이 50만원 이상이면 "VIP", 미만이면 "일반"을 반환하는 계산된 필드를 만드세요.',
    fieldName: 'VIP구분',
    availableFields: [
      { name: 'Sales', korName: '매출액', type: 'number' },
      { name: 'Discount', korName: '할인율', type: 'number' },
      { name: 'Quantity', korName: '수량', type: 'number' },
      { name: 'Category', korName: '카테고리', type: 'string' },
    ],
    explanation: 'IF 문으로 매출액이 50만원 이상인 경우 "VIP", 미만인 경우 "일반"을 반환합니다.',
    hint: 'IF [조건] THEN [참일 때 값] ELSE [거짓일 때 값] END',
    gaugeChange: { correct: 5, incorrect: -10 },
  },
  {
    id: 'calc_02',
    type: 'calc_field',
    subcategory: 'logic',
    difficulty: 'intermediate',
    day: 3,
    period: 'morning',
    instruction: '카테고리별 목표 이익률을 반환하는 CASE 문을 만드세요.\n가구: 0.15, 기술: 0.20, 사무용품: 0.10',
    fieldName: '목표이익률',
    availableFields: [
      { name: 'Category', korName: '카테고리', type: 'string' },
      { name: 'Sales', korName: '매출액', type: 'number' },
      { name: 'Profit', korName: '이익', type: 'number' },
    ],
    explanation: 'CASE 문은 하나의 필드에 대해 여러 조건을 깔끔하게 나열할 수 있습니다. ELSE로 기본값을 지정하면 안전합니다.',
    hint: 'CASE [필드] WHEN "값" THEN 결과 ... END',
    gaugeChange: { correct: 5, incorrect: -10 },
  },
  {
    id: 'calc_03',
    type: 'calc_field',
    subcategory: 'number',
    difficulty: 'intermediate',
    day: 3,
    period: 'afternoon',
    instruction: '매출액을 천원 단위로 반올림하는 계산된 필드를 만드세요.',
    fieldName: '반올림매출',
    availableFields: [
      { name: 'Sales', korName: '매출액', type: 'number' },
      { name: 'Quantity', korName: '수량', type: 'number' },
    ],
    explanation: 'ROUND의 두 번째 인자가 음수이면 정수 자릿수로 반올림합니다. -3이면 천 단위, -2이면 백 단위입니다.',
    hint: 'ROUND(숫자, 자릿수) - 음수 자릿수는 정수 자리에서 반올림합니다.',
    gaugeChange: { correct: 5, incorrect: -10 },
  },
  {
    id: 'calc_04',
    type: 'calc_field',
    subcategory: 'date',
    difficulty: 'intermediate',
    day: 4,
    period: 'morning',
    instruction: '주문일(Order Date)부터 배송일(Ship Date)까지 소요일을 구하는 계산된 필드를 만드세요.',
    fieldName: '배송소요일',
    availableFields: [
      { name: 'Order Date', korName: '주문일', type: 'date' },
      { name: 'Ship Date', korName: '배송일', type: 'date' },
      { name: 'Sales', korName: '매출액', type: 'number' },
    ],
    explanation: 'DATEDIFF("day", 시작일, 종료일)는 두 날짜 사이의 일수 차이를 반환합니다.',
    hint: 'DATEDIFF("단위", 시작날짜, 끝날짜)',
    gaugeChange: { correct: 5, incorrect: -10 },
  },
  {
    id: 'calc_05',
    type: 'calc_field',
    subcategory: 'parameter',
    difficulty: 'intermediate',
    day: 4,
    period: 'morning',
    instruction: '매개변수 [목표매출액]을 기준으로 매출 달성 여부를 반환하는 계산된 필드를 만드세요. ([Sales] >= [목표매출액] 이면 "달성", 아니면 "미달")',
    fieldName: '목표달성여부_매개변수',
    availableFields: [
      { name: 'Sales', korName: '매출액', type: 'number' },
      { name: '목표매출액', korName: '목표매출액(매개변수)', type: 'number' },
    ],
    explanation: '매개변수는 사용자가 값을 바꿀 수 있는 변수입니다. [목표매출액]과 [Sales]를 비교하면 목표 달성 여부를 동적으로 판별할 수 있습니다.',
    hint: '핵심 구조: IF [Sales] >= [목표매출액] THEN "달성" ELSE "미달" END',
    gaugeChange: { correct: 5, incorrect: -10 },
  },
  {
    id: 'calc_06',
    type: 'calc_field',
    subcategory: 'parameter',
    difficulty: 'intermediate',
    day: 4,
    period: 'afternoon',
    instruction: '매개변수 [지표 선택] 값에 따라 표시할 측정값을 바꾸는 계산식을 만드세요.\n"Sales" → SUM([Sales]), "Profit" → SUM([Profit]), "Quantity" → SUM([Quantity])',
    fieldName: '선택지표값',
    availableFields: [
      { name: '지표 선택', korName: '지표 선택(매개변수)', type: 'string' },
      { name: 'Sales', korName: '매출액', type: 'number' },
      { name: 'Profit', korName: '이익', type: 'number' },
      { name: 'Quantity', korName: '수량', type: 'number' },
    ],
    explanation: '매개변수 값에 따라 다른 측정값을 반환하면 하나의 차트에서 지표를 동적으로 전환할 수 있습니다. 실무 대시보드에서 자주 쓰는 패턴입니다.',
    hint: 'CASE [지표 선택] WHEN "Sales" THEN SUM([Sales]) ... END 형태로 작성해보세요.',
    gaugeChange: { correct: 5, incorrect: -10 },
  },
  {
    id: 'calc_07',
    type: 'calc_field',
    subcategory: 'comprehensive',
    difficulty: 'advanced',
    day: 5,
    period: 'morning',
    instruction: '할인율이 10% 이상인 주문의 매출만 합산한 후 백원 단위로 반올림하는 계산된 필드를 만드세요.',
    fieldName: '할인매출',
    availableFields: [
      { name: 'Sales', korName: '매출액', type: 'number' },
      { name: 'Discount', korName: '할인율', type: 'number' },
      { name: 'Quantity', korName: '수량', type: 'number' },
    ],
    explanation: 'IF 문으로 할인율 조건을 검사하고, ROUND로 결과를 반올림합니다. 함수를 중첩하여 복합적인 계산을 할 수 있습니다.',
    hint: 'IF 문 안에 ROUND를 넣거나, ROUND 안에 IF를 넣어보세요.',
    gaugeChange: { correct: 5, incorrect: -10 },
  },
  // === Chapter 8: 테이블 계산 ===
  {
    id: 'calc_08',
    type: 'calc_field',
    subcategory: 'table_calc',
    difficulty: 'intermediate',
    instruction: '월별 매출의 누적합을 계산하는 테이블 계산 필드를 만드세요.',
    fieldName: '누적매출',
    availableFields: [
      { name: 'Sales', korName: '매출액', type: 'number' },
      { name: 'Profit', korName: '이익', type: 'number' },
      { name: 'Quantity', korName: '수량', type: 'number' },
    ],
    explanation: 'RUNNING_SUM은 현재 뷰에서 누적 합계를 계산하는 대표적인 테이블 계산입니다. 계산 방향(Addressing) 설정에 따라 결과가 달라집니다.',
    hint: '누적합 = RUNNING_SUM(집계식). 보통 RUNNING_SUM(SUM([Sales]))를 사용합니다.',
    gaugeChange: { correct: 5, incorrect: -10 },
  },
  // === Chapter 9: LOD 표현식 ===
  {
    id: 'calc_09',
    type: 'calc_field',
    subcategory: 'lod',
    difficulty: 'advanced',
    instruction: 'LOD 표현식으로 카테고리별 평균 할인율을 구하는 계산된 필드를 만드세요.',
    fieldName: '카테고리평균할인',
    availableFields: [
      { name: 'Category', korName: '카테고리', type: 'string' },
      { name: 'Discount', korName: '할인율', type: 'number' },
      { name: 'Sales', korName: '매출액', type: 'number' },
    ],
    explanation: '{FIXED [차원] : 집계함수([측정값])} 형태로 뷰 레벨과 관계없이 특정 차원 기준으로 집계합니다. 여기서는 카테고리별 평균 할인율을 구합니다.',
    hint: '{FIXED [차원] : 집계함수([측정값])}',
    gaugeChange: { correct: 5, incorrect: -10 },
  },
  {
    id: 'calc_10',
    type: 'calc_field',
    subcategory: 'lod',
    difficulty: 'advanced',
    instruction: 'LOD 표현식으로 지역별 총 매출을 구하는 계산된 필드를 만드세요.',
    fieldName: '지역총매출',
    availableFields: [
      { name: 'Region', korName: '지역', type: 'string' },
      { name: 'Sales', korName: '매출액', type: 'number' },
      { name: 'Category', korName: '카테고리', type: 'string' },
    ],
    explanation: '{FIXED [Region] : SUM([Sales])}는 뷰에 어떤 차원이 있든 항상 지역별 총 매출을 반환합니다. 전체 대비 비율 계산 등에 활용됩니다.',
    hint: '{FIXED [지역] : SUM([매출])}',
    gaugeChange: { correct: 5, incorrect: -10 },
  },
  // === Chapter 10: KPI 대시보드 ===
  {
    id: 'calc_11',
    type: 'calc_field',
    subcategory: 'kpi',
    difficulty: 'intermediate',
    instruction: '매출이 30만원 이상이면 "목표달성", 미만이면 "미달"을 반환하는 KPI 판별 필드를 만드세요.',
    fieldName: '목표달성여부',
    availableFields: [
      { name: 'Sales', korName: '매출액', type: 'number' },
      { name: 'Profit', korName: '이익', type: 'number' },
      { name: 'Region', korName: '지역', type: 'string' },
    ],
    explanation: 'KPI 대시보드에서는 목표 대비 달성 여부를 판별하는 계산 필드가 핵심입니다. 이 필드를 색상에 넣으면 달성/미달이 시각적으로 구분됩니다.',
    hint: 'IF [Sales] >= 300000 THEN "목표달성" ELSE "미달" END',
    gaugeChange: { correct: 5, incorrect: -10 },
  },
  // === Chapter 12: 파레토 분석 ===
  {
    id: 'calc_12',
    type: 'calc_field',
    subcategory: 'pareto',
    difficulty: 'intermediate',
    instruction: '매출 대비 이익 비율을 백분율로 계산하는 필드를 만드세요. (이익/매출 * 100)',
    fieldName: '이익비율',
    availableFields: [
      { name: 'Sales', korName: '매출액', type: 'number' },
      { name: 'Profit', korName: '이익', type: 'number' },
      { name: 'Category', korName: '카테고리', type: 'string' },
    ],
    explanation: '이익 비율 = (이익 / 매출) * 100. 파레토 분석에서 각 항목의 수익성을 비교하는 데 사용됩니다.',
    hint: '[Profit] / [Sales] * 100',
    gaugeChange: { correct: 5, incorrect: -10 },
  },
  // === Chapter 13: RFM 고객 세분화 ===
  {
    id: 'calc_13',
    type: 'calc_field',
    subcategory: 'rfm',
    difficulty: 'intermediate',
    instruction: '매출 기준으로 고객 등급을 분류하세요. (IF/ELSEIF 또는 CASE TRUE 사용)\n50만 이상: "Gold", 20만 이상: "Silver", 나머지: "Bronze"',
    fieldName: '고객등급',
    availableFields: [
      { name: 'Sales', korName: '매출액', type: 'number' },
      { name: 'Quantity', korName: '수량', type: 'number' },
      { name: 'Category', korName: '카테고리', type: 'string' },
    ],
    explanation: '구간 분류는 IF/ELSEIF와 CASE TRUE 모두 가능합니다. 핵심은 조건 우선순위를 위에서 아래로 올바르게 배치하는 것입니다.',
    hint: 'CASE TRUE WHEN [Sales] >= 500000 THEN "Gold" ... END',
    gaugeChange: { correct: 5, incorrect: -10 },
  },
  {
    id: 'calc_14',
    type: 'calc_field',
    subcategory: 'rfm',
    difficulty: 'advanced',
    instruction: '할인율 구간에 따라 할인 등급을 분류하세요.\n20% 이상: "과다할인", 10% 이상: "적정", 미만: "최소할인"',
    fieldName: '할인등급',
    availableFields: [
      { name: 'Discount', korName: '할인율', type: 'number' },
      { name: 'Sales', korName: '매출액', type: 'number' },
      { name: 'Profit', korName: '이익', type: 'number' },
    ],
    explanation: '할인 구간을 분류하면 과도한 할인이 이익을 얼마나 갈아먹는지 분석할 수 있습니다. RFM과 함께 고객 수익성 분석에 활용됩니다.',
    hint: 'IF [Discount] >= 0.2 THEN "과다할인" ELSEIF ...',
    gaugeChange: { correct: 5, incorrect: -10 },
  },
  // === Chapter 14: 코호트 분석 ===
  {
    id: 'calc_15',
    type: 'calc_field',
    subcategory: 'cohort',
    difficulty: 'intermediate',
    instruction: '코호트 분석을 위해 고객별 최초 주문일을 구하는 LOD 계산식을 작성하세요.',
    fieldName: '고객최초주문일',
    availableFields: [
      { name: 'Customer Name', korName: '고객이름', type: 'string' },
      { name: 'Order Date', korName: '주문일', type: 'date' },
      { name: 'Sales', korName: '매출액', type: 'number' },
    ],
    explanation: '코호트 분석의 첫 단계는 고객별 최초 이벤트 시점을 고정하는 것입니다. FIXED LOD로 고객별 최초 주문일을 만들면 이후 경과 주차/월차 계산이 안정적으로 가능합니다.',
    hint: '{FIXED [Customer Name] : MIN([Order Date])}',
    gaugeChange: { correct: 5, incorrect: -10 },
  },
  // === Chapter 15: 시계열 분석 ===
  {
    id: 'calc_16',
    type: 'calc_field',
    subcategory: 'timeseries',
    difficulty: 'intermediate',
    instruction: '주문일을 분기(quarter) 단위로 절삭하는 계산된 필드를 만드세요.',
    fieldName: '주문분기',
    availableFields: [
      { name: 'Order Date', korName: '주문일', type: 'date' },
      { name: 'Ship Date', korName: '배송일', type: 'date' },
      { name: 'Sales', korName: '매출액', type: 'number' },
    ],
    explanation: 'DATETRUNC("quarter", 날짜)는 날짜를 해당 분기의 첫날로 절삭합니다. 분기별 시계열 분석에 필수적인 함수입니다.',
    hint: 'DATETRUNC("quarter", [Order Date])',
    gaugeChange: { correct: 5, incorrect: -10 },
  },
  // === Chapter 19: 스토리텔링 ===
  {
    id: 'calc_17',
    type: 'calc_field',
    subcategory: 'storytelling',
    difficulty: 'intermediate',
    instruction: '스토리 포인트 제목에 넣을 문구를 만드세요.\n형식: [Category] + " | 이익률 " + STR(ROUND(([Profit]/[Sales]) * 100, 1)) + "%"',
    fieldName: '스토리포인트제목',
    availableFields: [
      { name: 'Sales', korName: '매출액', type: 'number' },
      { name: 'Profit', korName: '이익', type: 'number' },
      { name: 'Category', korName: '카테고리', type: 'string' },
    ],
    explanation: '스토리텔링에서는 계산 결과를 의사결정자가 바로 읽을 수 있는 문구로 만드는 작업이 중요합니다. 수치 계산과 텍스트 결합을 함께 연습하는 문제입니다.',
    hint: '문자열 결합(+) + ROUND + STR 조합으로 제목 문구를 만드세요.',
    gaugeChange: { correct: 5, incorrect: -10 },
  },
  // === Chapter 20: 종합 ===
  {
    id: 'calc_18',
    type: 'calc_field',
    subcategory: 'comprehensive',
    difficulty: 'advanced',
    instruction: '수량이 20개 이상이고 할인율이 10% 미만인 주문만 매출을 합산하는 계산된 필드를 만드세요. 조건 미충족 시 0을 반환합니다.',
    fieldName: '우수주문매출',
    availableFields: [
      { name: 'Sales', korName: '매출액', type: 'number' },
      { name: 'Quantity', korName: '수량', type: 'number' },
      { name: 'Discount', korName: '할인율', type: 'number' },
    ],
    explanation: 'AND 연산자로 여러 조건을 결합합니다. 수량이 많고 할인이 적은 "우수 주문"만 집계하면 수익성 높은 거래 패턴을 분석할 수 있습니다.',
    hint: 'IF [Quantity] >= 20 AND [Discount] < 0.1 THEN [Sales] ELSE 0 END',
    gaugeChange: { correct: 5, incorrect: -10 },
  },
]
